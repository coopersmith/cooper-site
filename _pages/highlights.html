---
layout: page
title: Highlights
permalink: /highlights
---

<div id="highlights"></div>
<script>
async function loadHighlights() {
  const container = document.getElementById('highlights');
  try {
    const response = await fetch('/.netlify/functions/readwise-highlights');
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    const highlights = await response.json();
    if (!Array.isArray(highlights) || highlights.length === 0) {
      container.textContent = 'No highlights found.';
      return;
    }
    highlights.forEach(h => {
      const item = document.createElement('div');
      item.className = 'highlight';
      
      // Build comprehensive attribution
      let attribution = '';
      if (h.book_title) {
        attribution = h.book_title;
        if (h.author) {
          attribution += ` by ${h.author}`;
        }
      } else if (h.source) {
        attribution = h.source;
      } else if (h.title) {
        attribution = h.title;
      }
      
      // Add location information if available
      if (h.location) {
        attribution += ` (Location ${h.location})`;
      } else if (h.note) {
        attribution += ` (${h.note})`;
      }
      
      item.innerHTML = `
        <blockquote>
          <p>${h.text}</p>
          ${attribution ? `<cite>â€” ${attribution}</cite>` : ''}
        </blockquote>
      `;
      container.appendChild(item);
    });
  } catch (error) {
    console.error('Failed to load highlights:', error);
    container.textContent = 'Failed to load highlights.';
  }
}
loadHighlights();
</script>
